<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>算法和数据结构 | 双端队列</title>
    <meta name="description" content="基本的算法和数据结构">
    
    
    <link rel="preload" href="/Algorithms-DataStructures-Vuepress/assets/css/18.styles.9bfb5f3f.css" as="style"><link rel="preload" href="/Algorithms-DataStructures-Vuepress/assets/js/app.6d89c253.js" as="script"><link rel="preload" href="/Algorithms-DataStructures-Vuepress/assets/js/11.79d8fa09.js" as="script"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/10.f94f1dd9.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/1.e886998b.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/2.05c90dba.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/3.ce3e7e43.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/4.58272cc9.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/5.be95a916.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/6.73ad716e.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/7.cf87ace6.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/8.338d4234.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/9.7ae319d1.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/0.dccb1d1f.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/12.d71509c4.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/13.0cd9a29a.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/14.14b380d2.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/15.fa1ea035.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/16.401da94c.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/17.562f1a3c.js">
    <link rel="stylesheet" href="/Algorithms-DataStructures-Vuepress/assets/css/18.styles.9bfb5f3f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/Algorithms-DataStructures-Vuepress/" class="home-link router-link-active"><!----><span class="site-name">
      算法和数据结构
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/Algorithms-DataStructures-Vuepress/" class="nav-link">Home</a></div><a href="https://github.com/hanchenhao/Algorithms-DataStructures-Vuepress.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Algorithms-DataStructures-Vuepress/" class="nav-link">Home</a></div><a href="https://github.com/hanchenhao/Algorithms-DataStructures-Vuepress.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>目录</span><!----></p><ul class="sidebar-group-items"><li><a href="/Algorithms-DataStructures-Vuepress/" class="sidebar-link">基本的算法和数据结构</a></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="双端队列"><a href="#双端队列" aria-hidden="true" class="header-anchor">#</a> 双端队列</h1><p>双端队列是指允许两端都可以进行入队和出队操作的队列，其元素的逻辑结构仍是线性结构。将队列的两端分别称为前端和后端，两端都可以入队和出队。他看起来,有点像船上的甲板.</p><p>通常一个基本的队列都是在队列的后端加入,然后在队列前端移除,从而实现了一个先进先出的规则.而双端队列是指允许两端都可以进行入队和出队操作的队列，其元素的逻辑结构仍是线性结构.将队列的两端分别称为前端和后端，两端都可以入队和出队.</p><p>下面我们用一个非常简单的方式去实现一个双端队列:</p><pre class="language-swift"><code>
	<span class="token keyword">struct</span> <span class="token builtin">Deque</span><span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
	    
	    <span class="token keyword">var</span> array <span class="token operator">=</span> <span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	    
	    <span class="token keyword">var</span> <span class="token builtin">isEmpty</span><span class="token punctuation">:</span><span class="token builtin">Bool</span> <span class="token punctuation">{</span>
	        <span class="token keyword">return</span> array<span class="token punctuation">.</span><span class="token builtin">isEmpty</span>
	    <span class="token punctuation">}</span>
	    
	    <span class="token keyword">var</span> <span class="token builtin">count</span><span class="token punctuation">:</span> <span class="token builtin">Int</span> <span class="token punctuation">{</span>
	        <span class="token keyword">return</span> array<span class="token punctuation">.</span><span class="token builtin">count</span>
	    <span class="token punctuation">}</span>
	    
	    <span class="token keyword">mutating</span> <span class="token keyword">func</span> <span class="token function">enqueue</span><span class="token punctuation">(</span><span class="token number">_</span> element<span class="token punctuation">:</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	        array<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span>
	    <span class="token punctuation">}</span>
	    
	    <span class="token keyword">mutating</span> <span class="token keyword">func</span> <span class="token function">enqueueFront</span><span class="token punctuation">(</span><span class="token number">_</span> element<span class="token punctuation">:</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	        array<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> at<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span>
	    <span class="token punctuation">}</span>
	    
	    <span class="token keyword">mutating</span> <span class="token keyword">func</span> <span class="token function">dequeue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> T<span class="token operator">?</span> <span class="token punctuation">{</span>
	        <span class="token keyword">return</span> <span class="token builtin">isEmpty</span> <span class="token operator">?</span> <span class="token constant">nil</span> <span class="token punctuation">:</span> array<span class="token punctuation">.</span><span class="token function">removeFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	    <span class="token punctuation">}</span>
	    
	    <span class="token keyword">mutating</span> <span class="token keyword">func</span> <span class="token function">dequeueBack</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> T<span class="token operator">?</span> <span class="token punctuation">{</span>
	        <span class="token keyword">return</span> <span class="token builtin">isEmpty</span> <span class="token operator">?</span> <span class="token constant">nil</span> <span class="token punctuation">:</span> array<span class="token punctuation">.</span><span class="token function">removeLast</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	    <span class="token punctuation">}</span>
	
	    <span class="token keyword">func</span> <span class="token function">peekFront</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> T<span class="token operator">?</span> <span class="token punctuation">{</span>
	        <span class="token keyword">return</span> array<span class="token punctuation">.</span><span class="token builtin">first</span>
	    <span class="token punctuation">}</span>
	    
	    <span class="token keyword">func</span> <span class="token function">peekBack</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> T<span class="token operator">?</span> <span class="token punctuation">{</span>
	        <span class="token keyword">return</span> array<span class="token punctuation">.</span><span class="token builtin">first</span>
	    <span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

</code></pre><p>利用swift提供的array,我们很简单的实现了一个双端队列的基本功能,其两端都可以入队和出队.但是这个队列的效率并不是特别高,因为向头部插入和移除都会涉及申请新的内存，将已有数据迁移到新内存等内存移位操作,所以时间复杂度为 <strong>O(n)</strong></p><h2 id="一个更加高效的双端队列"><a href="#一个更加高效的双端队列" aria-hidden="true" class="header-anchor">#</a> 一个更加高效的双端队列</h2><p>因为<code>dequeue()</code>和<code>enqueueFront(_ element:T)</code>操作数组的头部内容,使内存移位,所以导致时间复杂度为 <strong>O(n)</strong>,</p><p>我们可以在创建双端队列的时候,在队列头部位置去插入一些空值来进行占位,像是这样:</p><pre class="language-swift"><code><span class="token punctuation">[</span>x<span class="token punctuation">,</span>x<span class="token punctuation">,</span>x<span class="token punctuation">,</span>x<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span>
</code></pre><p>然后,元素插入队首的时候,我们将插入的值将空值替换,比如我们在队首插入一个0,那么队列就会变成这个样子</p><pre class="language-swift"><code><span class="token punctuation">[</span>x<span class="token punctuation">,</span>x<span class="token punctuation">,</span>x<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span>
</code></pre><p>现在有一块空余的空间在队首,我们删除以及插入的操作其实都是在替换对应的元素,这样我们时间复杂度就也变成了 <strong>O(1)</strong></p><pre class="language-swift"><code>
<span class="token keyword">public</span> <span class="token keyword">struct</span> <span class="token builtin">DequeOptimized</span><span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">var</span> array<span class="token punctuation">:</span> <span class="token punctuation">[</span>T<span class="token operator">?</span><span class="token punctuation">]</span>
    <span class="token keyword">private</span> <span class="token keyword">var</span> head<span class="token punctuation">:</span> <span class="token builtin">Int</span>
    <span class="token keyword">private</span> <span class="token keyword">var</span> capacity<span class="token punctuation">:</span> <span class="token builtin">Int</span>
    
    <span class="token keyword">init</span><span class="token punctuation">(</span>capacity<span class="token punctuation">:</span> <span class="token builtin">Int</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>capacity <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>capacity<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        array <span class="token operator">=</span> <span class="token punctuation">[</span>T<span class="token operator">?</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span>repeating<span class="token punctuation">:</span> <span class="token constant">nil</span><span class="token punctuation">,</span> <span class="token builtin">count</span><span class="token punctuation">:</span> capacity<span class="token punctuation">)</span>
        head <span class="token operator">=</span> capacity
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">var</span> <span class="token builtin">isEmpty</span><span class="token punctuation">:</span> <span class="token builtin">Bool</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token builtin">count</span> <span class="token operator">==</span> <span class="token number">0</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">var</span> <span class="token builtin">count</span><span class="token punctuation">:</span> <span class="token builtin">Int</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> array<span class="token punctuation">.</span><span class="token builtin">count</span> <span class="token operator">-</span> head
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">mutating</span> <span class="token keyword">func</span> <span class="token function">enqueue</span><span class="token punctuation">(</span><span class="token number">_</span> element<span class="token punctuation">:</span> T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        array<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">mutating</span> <span class="token keyword">func</span> <span class="token function">enqueueFront</span><span class="token punctuation">(</span><span class="token number">_</span> element<span class="token punctuation">:</span> T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> head <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>  <span class="token comment">//如果首部位置为0,则没有空余空间,应该分配一定的空置空间给队列</span>
            capacity <span class="token operator">*</span><span class="token operator">=</span> <span class="token number">2</span>	<span class="token comment">//扩容</span>
            
            <span class="token comment">//创建空余空间</span>
            <span class="token keyword">let</span> emptySpace <span class="token operator">=</span> <span class="token punctuation">[</span>T<span class="token operator">?</span><span class="token punctuation">]</span><span class="token punctuation">(</span>repeating<span class="token punctuation">:</span> <span class="token constant">nil</span><span class="token punctuation">,</span> <span class="token builtin">count</span><span class="token punctuation">:</span> capacity<span class="token punctuation">)</span>
            <span class="token comment">//将空余空间压入队列</span>
            array<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>contentsOf<span class="token punctuation">:</span> emptySpace<span class="token punctuation">,</span> at<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span>
            head <span class="token operator">=</span> capacity <span class="token comment">//设置头部位置</span>
        <span class="token punctuation">}</span>
        
        head <span class="token operator">-</span><span class="token operator">=</span> <span class="token number">1</span> <span class="token comment">//移位</span>
        array<span class="token punctuation">[</span>head<span class="token punctuation">]</span> <span class="token operator">=</span> element <span class="token comment">//赋值</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">mutating</span> <span class="token keyword">func</span> <span class="token function">dequeue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> T<span class="token operator">?</span> <span class="token punctuation">{</span>
        <span class="token keyword">guard</span> head <span class="token operator">&lt;</span> array<span class="token punctuation">.</span><span class="token builtin">count</span><span class="token punctuation">,</span> <span class="token keyword">let</span> element <span class="token operator">=</span> array<span class="token punctuation">[</span>head<span class="token punctuation">]</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token constant">nil</span> <span class="token punctuation">}</span>
        
        array<span class="token punctuation">[</span>head<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">nil</span>
        head <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">1</span>
        
        <span class="token keyword">if</span> capacity <span class="token operator">&gt;</span> <span class="token number">10</span> <span class="token operator">&amp;&amp;</span> head <span class="token operator">&gt;=</span> capacity<span class="token operator">*</span><span class="token number">2</span> <span class="token punctuation">{</span> <span class="token comment">//处理冗余空间</span>
            <span class="token keyword">let</span> amountToRemove <span class="token operator">=</span> capacity <span class="token operator">+</span> capacity<span class="token operator">/</span><span class="token number">2</span>
            array<span class="token punctuation">.</span><span class="token function">removeFirst</span><span class="token punctuation">(</span>amountToRemove<span class="token punctuation">)</span>
            head <span class="token operator">-</span><span class="token operator">=</span> amountToRemove
            capacity <span class="token operator">/</span><span class="token operator">=</span> <span class="token number">2</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> element
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">mutating</span> <span class="token keyword">func</span> <span class="token function">dequeueBack</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> T<span class="token operator">?</span> <span class="token punctuation">{</span>
        
        <span class="token keyword">return</span> <span class="token builtin">isEmpty</span> <span class="token operator">?</span> <span class="token constant">nil</span> <span class="token punctuation">:</span> array<span class="token punctuation">.</span><span class="token function">removeLast</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">func</span> <span class="token function">peekFront</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> T<span class="token operator">?</span> <span class="token punctuation">{</span>
        
        <span class="token keyword">return</span> <span class="token builtin">isEmpty</span> <span class="token operator">?</span> <span class="token constant">nil</span> <span class="token punctuation">:</span> array<span class="token punctuation">[</span>head<span class="token punctuation">]</span>

    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">func</span> <span class="token function">peekBack</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> T<span class="token operator">?</span> <span class="token punctuation">{</span>
        
        <span class="token keyword">return</span> <span class="token builtin">isEmpty</span> <span class="token operator">?</span> <span class="token constant">nil</span> <span class="token punctuation">:</span> array<span class="token punctuation">.</span><span class="token builtin">last</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token constant">nil</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><div class="content edit-link"><a href="https://github.com/hanchenhao/Algorithms-DataStructures-Vuepress.git/edit/master/docs/Deque/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div><!----></div></div></div>
    <script src="/Algorithms-DataStructures-Vuepress/assets/js/11.79d8fa09.js" defer></script><script src="/Algorithms-DataStructures-Vuepress/assets/js/app.6d89c253.js" defer></script>
  </body>
</html>
