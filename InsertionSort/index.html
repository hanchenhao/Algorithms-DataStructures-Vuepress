<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>算法和数据结构 | 插入排序</title>
    <meta name="description" content="基本的算法和数据结构">
    
    
    <link rel="preload" href="/Algorithms-DataStructures-Vuepress/assets/css/18.styles.9bfb5f3f.css" as="style"><link rel="preload" href="/Algorithms-DataStructures-Vuepress/assets/js/app.6d89c253.js" as="script"><link rel="preload" href="/Algorithms-DataStructures-Vuepress/assets/js/8.338d4234.js" as="script"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/10.f94f1dd9.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/1.e886998b.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/2.05c90dba.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/3.ce3e7e43.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/4.58272cc9.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/5.be95a916.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/6.73ad716e.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/7.cf87ace6.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/9.7ae319d1.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/0.dccb1d1f.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/11.79d8fa09.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/12.d71509c4.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/13.0cd9a29a.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/14.14b380d2.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/15.fa1ea035.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/16.401da94c.js"><link rel="prefetch" href="/Algorithms-DataStructures-Vuepress/assets/js/17.562f1a3c.js">
    <link rel="stylesheet" href="/Algorithms-DataStructures-Vuepress/assets/css/18.styles.9bfb5f3f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/Algorithms-DataStructures-Vuepress/" class="home-link router-link-active"><!----><span class="site-name">
      算法和数据结构
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/Algorithms-DataStructures-Vuepress/" class="nav-link">Home</a></div><a href="https://github.com/hanchenhao/Algorithms-DataStructures-Vuepress.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Algorithms-DataStructures-Vuepress/" class="nav-link">Home</a></div><a href="https://github.com/hanchenhao/Algorithms-DataStructures-Vuepress.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>目录</span><!----></p><ul class="sidebar-group-items"><li><a href="/Algorithms-DataStructures-Vuepress/" class="sidebar-link">基本的算法和数据结构</a></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="插入排序"><a href="#插入排序" aria-hidden="true" class="header-anchor">#</a> 插入排序</h1><p>插入排序的工作方式如下：</p><ul><li>首先，将这些待排序的数字放在一个数组中，成为未排序的原始数组。</li><li>从其中取出一个数字，具体取哪个无所谓。为简单起见，每次都直接取出第一个元素。</li><li>将这个数字插入到一个新的已排序数组中。</li><li>然后再次从未排序数组中取出一个数字，将其插入到已排序数组中。它要么插在第一个元素的前面，要么插在后面，来保证这两个数字是有序的。</li><li>再一次从未排序数组中取出一个元素，安插在新数组的合适位置，以求新数组依然有序。</li><li>一直这样做下去，直到未排序数组中没有数字了为止。这样就可以达到排序的目的了。</li></ul><p>这就是算法叫“插入”排序的原因，因为排序过程中不断地从未排序数组中取出元素插入到已排序的目标数组。</p><h2 id="举例"><a href="#举例" aria-hidden="true" class="header-anchor">#</a> 举例</h2><p>例如，待排序的数组为 <code>[ 8, 3, 5, 4, 6 ]</code>。</p><p>取出第一个数字 <code>8</code>，将它插入到已排序数组中。已排序数组目前还是空的，所以这个过程非常简单。已排序数组现在为 <code>[ 8 ]</code>，未排序数组为 <code>[ 3, 5, 4, 6 ]</code>。</p><p>取出下一个数字 <code>3</code>，将其插入到已排序数组。他应该在 <code>8</code> 的前面，所以已排序数组现在为 <code>[ 3, 8 ]</code>，未排序数组缩减为 <code>[ 5, 4, 6 ]</code></p><p>取出下一个数字 <code>5</code>，将其插入到已排序数组中。它应该在 <code>3</code> 和 <code>8</code> 之间。所以，现在已排序数组为 <code>[ 3, 5, 8]</code>,未排序数组为 <code>[ 4, 6 ]</code>。</p><p>重复以上过程，直到未排序数组为空为止。</p><h2 id="原地排序"><a href="#原地排序" aria-hidden="true" class="header-anchor">#</a> 原地排序</h2><p>根据上面的解释，排序过程中似乎使用了两个数组，一个用于存放未排序的的元素，另一个存放已排序的元素。</p><p>但实际上插入排序可以“原地”进行，无需再创建另一个数组。只需要标记好哪部分是未排序的，哪部分是已排序的即可。</p><p>初始数组为 <code>[ 8, 3, 5, 4, 6 ]</code>。我们使用 <code>|</code> 符号来分隔已排序和未排序部分：</p><pre><code>[| 8, 3, 5, 4, 6 ]
</code></pre><p>上图显示已排序部分为空，未排序部分的第一个数字为 <code>8</code>。</p><p>处理完第一个数字之后，数组如下所示：</p><pre><code>[ 8 | 3, 5, 4, 6 ]
</code></pre><p>目前，已排序的部分为 <code>[ 8 ]</code>，未排序的部分为 <code>[ 3, 5, 4, 6 ]</code>。分隔符 <code>|</code> 向右位移了一个单位。</p><p>下面列出了排序过程中数组内容的变化：</p><pre><code>[| 8, 3, 5, 4, 6 ]
[ 8 | 3, 5, 4, 6 ]
[ 3, 8 | 5, 4, 6 ]
[ 3, 5, 8 | 4, 6 ]
[ 3, 4, 5, 8 | 6 ]
[ 3, 4, 5, 6, 8 |]
</code></pre><p>每一步分隔符 <code>|</code> 都向右位移一个单位。可以观察到，数组开头到分隔符之间的部分总是已排序的。未排序部分每减少一个元素，已排序部分就增加一个，直到未排序元素为空为止。</p><h2 id="如何插入"><a href="#如何插入" aria-hidden="true" class="header-anchor">#</a> 如何插入</h2><p>每个周期开始，取出未排序数组的头部元素，将其插入到已排序数组中。这时候，必须要保证元素被插入到了正确的位置。怎么做呢？</p><p>现在假设已经完成了前面几个元素的排序，数组看起来像下面这样：</p><pre><code>[ 3, 5, 8 | 4, 6 ]
</code></pre><p>下一个待排序的数字是 <code>4</code>。我们要做的就是将其插入到已排序数组 <code>[ 3, 5, 8 ]</code> 的某个位置。</p><p>下面提供了一个实现思路：跟前面的元素 <code>8</code> 进行比较。</p><pre><code>[ 3, 5, 8, 4 | 6 ]
        ^
</code></pre><p>它比 <code>4</code> 大吗？是的，所以 <code>4</code> 应该放到 <code>8</code> 的前面去。我们将两个数字交换位置来达到目的：</p><pre><code>[ 3, 5, 4, 8 | 6 ]
        &lt;--&gt;
       已交换
</code></pre><p>至此还没有结束。交换之后，新的排在前面的元素 <code>5</code> 也比 <code>4</code> 大。我们如法炮制，也将这两个数字交换位置：</p><pre><code>[ 3, 4, 5, 8 | 6 ]
     &lt;--&gt;
    已交换
</code></pre><p>继续，再次检查排在前面的新元素 <code>3</code>，它比 <code>4</code> 大吗？不，它必 <code>4</code> 小，这就意味着 <code>4</code> 已经在正确的位置上了。已排序的数组也再次变得有序了。</p><p>这就是插入排序算法的内循环的文字描述了，具体的代码在下一节给出。通过交换数字的方式，我们将待排序的元素移动到了已排序数组的正确位置上。</p><pre class="language-swift"><code>
<span class="token keyword">func</span> insertionSort<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> <span class="token builtin">Comparable</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>array<span class="token punctuation">:</span> <span class="token punctuation">[</span>T<span class="token punctuation">]</span> <span class="token punctuation">,</span> <span class="token number">_</span> compare<span class="token punctuation">:</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span>T<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">Bool</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>T<span class="token punctuation">]</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> array
    
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&lt;</span>a<span class="token punctuation">.</span><span class="token builtin">count</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> n <span class="token operator">=</span> i
        <span class="token keyword">while</span> n <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">compare</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token punctuation">,</span> a<span class="token punctuation">[</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            a<span class="token punctuation">.</span><span class="token function">swapAt</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
            n <span class="token operator">-</span><span class="token operator">=</span> <span class="token number">1</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> a
<span class="token punctuation">}</span>


</code></pre></div><div class="content edit-link"><a href="https://github.com/hanchenhao/Algorithms-DataStructures-Vuepress.git/edit/master/docs/InsertionSort/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div><!----></div></div></div>
    <script src="/Algorithms-DataStructures-Vuepress/assets/js/8.338d4234.js" defer></script><script src="/Algorithms-DataStructures-Vuepress/assets/js/app.6d89c253.js" defer></script>
  </body>
</html>
